category Person {
    asset User {
        | userRights
            ->  service.exploitationOfRemoteServices
    }

    asset Administrator {
        # privilegedAccountManagement
            info: "https://attack.mitre.org/mitigations/M1026/"
            ->  service.exploitationOfRemoteServices
    }
}

category Software {
    asset Service {
        & exploitationOfRemoteServices
            info: "An adversary may need to determine if the remote system is in a vulnerable state, which may be done through Network Service Scanning or other Discovery methods."
            ->  _exploitationOfRemoteServices

        & _exploitationOfRemoteServices
            ->  exploitationForPrivilegeEscalation // leads to Exploitation for Privilege Escalation attack

        | exploitationForPrivilegeEscalation

        # applicationIsolationAndSandboxing
            info: "https://attack.mitre.org/mitigations/M1048/"
            ->  _exploitationOfRemoteServices

        # threatIntelligenceProgram
            info: "https://attack.mitre.org/mitigations/M1019/"
            ->  _exploitationOfRemoteServices         

    }

    abstractAsset OS {  
        & networkServiceScan
            info: "Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation"
            ->  service.exploitationOfRemoteServices

        # disableOrRemoveFeatureOrProgram 
            info: "https://attack.mitre.org/techniques/T1064/"
            ->  service.exploitationOfRemoteServices  

        # exploitProtection
            info: "https://attack.mitre.org/mitigations/M1050/"
            ->  service._exploitationOfRemoteServices

        # updateSoftware
            info: "https://attack.mitre.org/mitigations/M1051/"
            ->  service._exploitationOfRemoteServices
        
    }
}

category Network {
    asset ExternalNetwork {
        # networkSegmentation // Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.
            info: "https://attack.mitre.org/mitigations/M1030/"
            ->  service.exploitationOfRemoteServices

    }
    asset InternalNetwork {
        # networkSegmentation // Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.
            info: "https://attack.mitre.org/mitigations/M1030/"
            ->  service.exploitationOfRemoteServices

        # vulnerabilityScanning // Regularly scan the internal network for available services to identify new and potentially vulnerable services.
            info: "https://attack.mitre.org/mitigations/M1016/"
            ->  service.exploitationOfRemoteServices  
    }
}



associations{
    User [user] 1-* <--Use--> 1-* [service] Service
    Administrator [administrator] 1-* <--Use--> 1-* [service] Service
    OS [os] 1 <--Contain--> 1-* [service] Service 
    InternalNetwork [internalNetwork] 1 <--Contain--> 1-* [service] Service
    ExternalNetwork [externalNetwork] 1 <--Contain--> 1-* [service] Service
    
}